{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";import'../../style/adminOrderPage.css';import Pagination from\"../common/Pagination\";import ApiService from\"../../service/ApiService\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const OrderStatus=[\"PENDING\",\"CONFIRMED\",\"SHIPPED\",\"DELIVERED\",\"CANCELLED\",\"RETURNED\"];const AdminOrdersPage=()=>{const[orders,setOrders]=useState([]);const[filteredOrders,setFilteredOrders]=useState([]);const[statusFilter,setStatusFilter]=useState('');const[searchStatus,setSearchStatus]=useState('');const[currentPage,setCurrentPage]=useState(1);const[totalPages,setTotalPages]=useState(0);const[error,setError]=useState(null);const itemsPerPage=10;const navigate=useNavigate();useEffect(()=>{fetchOrders();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[searchStatus,currentPage]);const fetchOrders=async()=>{try{let response;if(searchStatus){response=await ApiService.getAllOrderItemsByStatus(searchStatus);}else{response=await ApiService.getAllOrders();}const orderList=response.orderItemList||[];setTotalPages(Math.ceil(orderList.length/itemsPerPage));setOrders(orderList);setFilteredOrders(orderList.slice((currentPage-1)*itemsPerPage,currentPage*itemsPerPage));}catch(error){var _error$response,_error$response$data;setError(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||error.message||'unable to fetch orders');setTimeout(()=>{setError('');},3000);}};const handleFilterChange=e=>{const filterValue=e.target.value;setStatusFilter(filterValue);setCurrentPage(1);if(filterValue){const filtered=orders.filter(order=>order.status===filterValue);setFilteredOrders(filtered.slice(0,itemsPerPage));setTotalPages(Math.ceil(filtered.length/itemsPerPage));}else{setFilteredOrders(orders.slice(0,itemsPerPage));setTotalPages(Math.ceil(orders.length/itemsPerPage));}};const handleSearchStatusChange=async e=>{setSearchStatus(e.target.value);setCurrentPage(1);};const handleOrderDetails=id=>{navigate(\"/admin/order-details/\".concat(id));};return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-orders-page\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Orders\"}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"statusFilter\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Filter By Status\"}),/*#__PURE__*/_jsxs(\"select\",{value:statusFilter,onChange:handleFilterChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All\"}),OrderStatus.map(status=>/*#__PURE__*/_jsx(\"option\",{value:status,children:status},status))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"searchStatus\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Search By Status\"}),/*#__PURE__*/_jsxs(\"select\",{value:searchStatus,onChange:handleSearchStatusChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All\"}),OrderStatus.map(status=>/*#__PURE__*/_jsx(\"option\",{value:status,children:status},status))]})]})]}),/*#__PURE__*/_jsxs(\"table\",{className:\"orders-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Order ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Customer\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Price\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date Ordered\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filteredOrders.map(order=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:order.id}),/*#__PURE__*/_jsx(\"td\",{children:order.user.name}),/*#__PURE__*/_jsx(\"td\",{children:order.status}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",order.price.toFixed(2)]}),/*#__PURE__*/_jsx(\"td\",{children:new Date(order.createdAt).toLocaleDateString()}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleOrderDetails(order.id),children:\"Details\"})})]},order.id))})]}),/*#__PURE__*/_jsx(Pagination,{currentPage:currentPage,totalPages:totalPages,onPageChange:page=>setCurrentPage(page)})]});};export default AdminOrdersPage;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","Pagination","ApiService","jsx","_jsx","jsxs","_jsxs","OrderStatus","AdminOrdersPage","orders","setOrders","filteredOrders","setFilteredOrders","statusFilter","setStatusFilter","searchStatus","setSearchStatus","currentPage","setCurrentPage","totalPages","setTotalPages","error","setError","itemsPerPage","navigate","fetchOrders","response","getAllOrderItemsByStatus","getAllOrders","orderList","orderItemList","Math","ceil","length","slice","_error$response","_error$response$data","data","message","setTimeout","handleFilterChange","e","filterValue","target","value","filtered","filter","order","status","handleSearchStatusChange","handleOrderDetails","id","concat","className","children","onChange","map","user","name","price","toFixed","Date","createdAt","toLocaleDateString","onClick","onPageChange","page"],"sources":["D:/2025.1/CNW/Web-Project-20251/react/src/component/admin/AdminOrderPage.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport '../../style/adminOrderPage.css'\r\nimport Pagination from \"../common/Pagination\";\r\nimport ApiService from \"../../service/ApiService\";\r\n\r\n\r\nconst OrderStatus = [\"PENDING\", \"CONFIRMED\", \"SHIPPED\", \"DELIVERED\", \"CANCELLED\", \"RETURNED\"];\r\n\r\n\r\nconst AdminOrdersPage = () => {\r\n\r\n    const [orders, setOrders] = useState([]);\r\n    const [filteredOrders, setFilteredOrders] = useState([]);\r\n    const [statusFilter, setStatusFilter] = useState('');\r\n    const [searchStatus, setSearchStatus] = useState('');\r\n\r\n    const [currentPage, setCurrentPage] = useState(1);\r\n    const [totalPages, setTotalPages] = useState(0);\r\n    const [error, setError] = useState(null);\r\n    const itemsPerPage = 10;\r\n\r\n    const navigate = useNavigate();\r\n\r\n    useEffect(() => {\r\n        fetchOrders();\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [searchStatus, currentPage]);\r\n\r\n\r\n\r\n    const fetchOrders = async () => {\r\n\r\n        try {\r\n            let response;\r\n            if(searchStatus){\r\n                response = await ApiService.getAllOrderItemsByStatus(searchStatus);\r\n            }else{\r\n                response = await ApiService.getAllOrders();\r\n            }\r\n            const orderList = response.orderItemList || [];\r\n\r\n            setTotalPages(Math.ceil(orderList.length/itemsPerPage));\r\n            setOrders(orderList);\r\n            setFilteredOrders(orderList.slice((currentPage -1) * itemsPerPage, currentPage * itemsPerPage));\r\n\r\n\r\n        } catch (error) {\r\n            setError(error.response?.data?.message || error.message || 'unable to fetch orders')\r\n            setTimeout(()=>{\r\n                setError('')\r\n            }, 3000)\r\n        }\r\n    }\r\n\r\n    const handleFilterChange = (e) =>{\r\n        const filterValue = e.target.value;\r\n        setStatusFilter(filterValue)\r\n        setCurrentPage(1);\r\n\r\n        if (filterValue) {\r\n            const filtered = orders.filter(order => order.status === filterValue);\r\n            setFilteredOrders(filtered.slice(0, itemsPerPage));\r\n            setTotalPages(Math.ceil(filtered.length / itemsPerPage));\r\n        }else{\r\n            setFilteredOrders(orders.slice(0, itemsPerPage));\r\n            setTotalPages(Math.ceil(orders.length / itemsPerPage));\r\n        }\r\n    }\r\n\r\n\r\n    const handleSearchStatusChange = async (e) => {\r\n        setSearchStatus(e.target.value);\r\n        setCurrentPage(1);\r\n    }\r\n\r\n    const handleOrderDetails = (id) => {\r\n        navigate(`/admin/order-details/${id}`)\r\n    }\r\n\r\n\r\n    return (\r\n        <div className=\"admin-orders-page\">\r\n            <h2>Orders</h2>\r\n            {error && <p className=\"error-message\">{error}</p>}\r\n            <div className=\"filter-container\">\r\n                <div className=\"statusFilter\">\r\n                    <label >Filter By Status</label>\r\n                    <select value={statusFilter} onChange={handleFilterChange}>\r\n                        <option value=\"\">All</option>\r\n                        {OrderStatus.map(status=>(\r\n                            <option key={status} value={status}>{status}</option>\r\n                        ))}\r\n                    </select>\r\n                </div>\r\n                <div className=\"searchStatus\">\r\n                <label>Search By Status</label>\r\n                    <select value={searchStatus} onChange={handleSearchStatusChange}>\r\n                        <option value=\"\">All</option>\r\n                        {OrderStatus.map(status=>(\r\n                            <option key={status} value={status}>{status}</option>\r\n                        ))}\r\n                    </select>\r\n\r\n                </div>\r\n            </div>\r\n\r\n            <table className=\"orders-table\">\r\n                <thead>\r\n                    <tr>\r\n                        <th>Order ID</th>\r\n                        <th>Customer</th>\r\n                        <th>Status</th>\r\n                        <th>Price</th>\r\n                        <th>Date Ordered</th>\r\n                        <th>Actions</th>\r\n                    </tr>\r\n                </thead>\r\n\r\n                <tbody>\r\n                    {filteredOrders.map(order => (\r\n                        <tr key={order.id}>\r\n                            <td>{order.id}</td>\r\n                            <td>{order.user.name}</td>\r\n                            <td>{order.status}</td>\r\n                            <td>${order.price.toFixed(2)}</td>\r\n                            <td>{new Date(order.createdAt).toLocaleDateString()}</td>\r\n                            <td>\r\n                                <button onClick={()=> handleOrderDetails(order.id)}>Details</button>\r\n                            </td>\r\n                        </tr>\r\n                    ))}\r\n                </tbody>\r\n\r\n            </table>\r\n\r\n            <Pagination\r\n            currentPage={currentPage}\r\n            totalPages={totalPages}\r\n            onPageChange={(page)=> setCurrentPage(page)}/>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default AdminOrdersPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}