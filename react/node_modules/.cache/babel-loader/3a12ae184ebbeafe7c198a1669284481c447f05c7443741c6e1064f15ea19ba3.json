{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useLocation}from\"react-router-dom\";import ProductList from\"../common/ProductList\";import Pagination from\"../common/Pagination\";import CategorySidebar from\"../common/CategorySidebar\";import ApiService from\"../../service/ApiService\";import'../../style/home.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Home=()=>{const location=useLocation();const[products,setProducts]=useState([]);const[currentPage,setCurrentPage]=useState(1);const[totalPages,setTotalPages]=useState(0);const[error,setError]=useState(null);const itemsPerPage=10;useEffect(()=>{const fetchProducts=async()=>{try{let allProducts=[];const queryparams=new URLSearchParams(location.search);const searchItem=queryparams.get('search');if(searchItem){const response=await ApiService.searchProducts(searchItem);allProducts=response.productList||[];}else{const response=await ApiService.getAllProducts();allProducts=response.productList||[];}setTotalPages(Math.ceil(allProducts.length/itemsPerPage));setProducts(allProducts.slice((currentPage-1)*itemsPerPage,currentPage*itemsPerPage));}catch(error){var _error$response,_error$response$data;setError(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||error.message||'unable to fetch products');}};fetchProducts();},[location.search,currentPage]);return/*#__PURE__*/_jsx(\"div\",{className:\"home\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"home-container\",children:[/*#__PURE__*/_jsx(CategorySidebar,{}),/*#__PURE__*/_jsx(\"div\",{className:\"home-content\",children:error?/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:error}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(ProductList,{products:products}),/*#__PURE__*/_jsx(Pagination,{currentPage:currentPage,totalPages:totalPages,onPageChange:page=>setCurrentPage(page)})]})})]})});};export default Home;","map":{"version":3,"names":["React","useEffect","useState","useLocation","ProductList","Pagination","CategorySidebar","ApiService","jsx","_jsx","jsxs","_jsxs","Home","location","products","setProducts","currentPage","setCurrentPage","totalPages","setTotalPages","error","setError","itemsPerPage","fetchProducts","allProducts","queryparams","URLSearchParams","search","searchItem","get","response","searchProducts","productList","getAllProducts","Math","ceil","length","slice","_error$response","_error$response$data","data","message","className","children","onPageChange","page"],"sources":["D:/2025.1/CNW/Web-Project-20251/react/src/component/pages/Home.jsx"],"sourcesContent":["import React, {useEffect, useState} from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport ProductList from \"../common/ProductList\";\r\nimport Pagination from \"../common/Pagination\";\r\nimport CategorySidebar from \"../common/CategorySidebar\";\r\nimport ApiService from \"../../service/ApiService\";\r\nimport '../../style/home.css';\r\n\r\n\r\nconst Home = () => {\r\n    const location = useLocation();\r\n    const [products, setProducts] = useState([]);\r\n    const [currentPage, setCurrentPage] = useState(1);\r\n    const [totalPages, setTotalPages] = useState(0);\r\n    const [error, setError] = useState(null);\r\n    const itemsPerPage = 10;\r\n\r\n    useEffect(()=> {\r\n\r\n        const fetchProducts = async () => {\r\n            try{\r\n                let allProducts = [];\r\n                const queryparams = new URLSearchParams(location.search);\r\n                const searchItem = queryparams.get('search')\r\n\r\n                if (searchItem) {\r\n                    const response = await ApiService.searchProducts(searchItem);\r\n                    allProducts = response.productList || [];\r\n                }else{\r\n                    const response = await ApiService.getAllProducts();\r\n                    allProducts = response.productList || [];\r\n\r\n                }\r\n\r\n                setTotalPages(Math.ceil(allProducts.length/itemsPerPage));\r\n                setProducts(allProducts.slice((currentPage -1) * itemsPerPage, currentPage * itemsPerPage));\r\n               \r\n            }catch(error){\r\n                setError(error.response?.data?.message || error.message || 'unable to fetch products')\r\n            }\r\n        }\r\n\r\n        fetchProducts();\r\n\r\n    },[location.search, currentPage])\r\n\r\n\r\n    return(\r\n        <div className=\"home\">\r\n            <div className=\"home-container\">\r\n                <CategorySidebar />\r\n                <div className=\"home-content\">\r\n                    {error ? (\r\n                        <p className=\"error-message\">{error}</p>\r\n                    ):(\r\n                        <div>\r\n                            <ProductList products={products}/>\r\n                            <Pagination  currentPage={currentPage}\r\n                            totalPages={totalPages}\r\n                            onPageChange={(page)=> setCurrentPage(page)}/>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n\r\n\r\n}\r\n\r\nexport default Home;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}